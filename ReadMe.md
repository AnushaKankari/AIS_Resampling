# **ARTIFICIAL IMMUNE SYSTEMS BASED RESAMPLING FOR DEALING WITH CLASS IMBALANCE**

## **1. Project Goal:**
Many real-world datasets suffer from the class imbalance problem.Frequently, either oversampling or undersampling strategies are applied to balance the dataset. From the past few decades, Artificial Immune Systems (AIS) defined as the intelligent computational algorithms inspired by the biological immune systems and gained a lot of attention.Researchers aimed to develop various immune-based algorithms to address the complex real-world problems for a wide variety of application domains. Namely, there has been some research works where AIS are applied to solve specific problems that suffer from the class imbalance problem. However, these methods were applied as the learning algorithm to solve the tasks and were not used as a resampling method. Only one work exists that uses some techniques of AIS to address the class imbalance problem [8].

The goal of this project is to explore the use of AIS as a data resampling strategy to tackle the class imbalance problem. In this study, we will test, evaluate and compare different approaches for integrating AIS techniques as resampling methods to address the class imbalance problem. Our experiments will be carried out using a set of the public available imbalanced data sets from Health and Fraud detection fields.

## **2. Project Implementation Details:**
**Programming Language:** Python
**Tools:** Jupyter Notebook
**Cloud-based Platforms:** Kaggle and Google colab
**Downloaded Datasets from:** Kaggle, UCI repository and Keel repository.

## **3. Introduction to Datasets:**
In our study, we considered a set of imbalanced data sets related to the Health and Fraud detection fields that are listed in below table.
![image](https://user-images.githubusercontent.com/58121387/115747984-c0ffa000-a363-11eb-991b-53b837382f12.png)

## **4. Exploratory Data Analysis:**

## **4. Resampling and Modeling:**

## **6. AIS Resampling and Modeling:**
  #### ** 6.1 Implementation Details**
  In this section, we present the different key functions introduced as part of the AIS algorithm and explain their goal.
**1.	Initial Population:** Initialize the population at random depending on the minority class distribution of each feature of a dataset. The population size and feature size are input parameters that generate the initial population. It contains a number of rows equal to population size and a number of columns equivalent to feature size. The output population contains chromosomes/tuples similar to the minority class instances of a given dataset.
**2.	Fitness score:** This function calculates the F-score of each chromosome/tuple of the population. The population, the classifier used to calculate the f-score, the train, and the test sets are given as input parameters. Each chromosome/tuple of a population is appended to the train set, fit to the model using the updated train set, using the trained model results are predicted on the test set, and f-score for that chromosome/tuple is calculated. This way, for each chromosome, their respective f-scores are calculated and stored. A sorted list of chromosomes with their respective scores is the output of this function.
**3.	Selection:** Choose the best-fitting chromosomes as parents in order to pass on genes to the next generation to build a new population. This function requires two inputs one is the sorted population generated by the fitness score function and the other is the parent size that indicates how many chromosomes must be selected as parents for the next population generation. Based on this size, the best chromosomes/tuples from the sorted population are selected as the population for next generation which is the outcome of this function.
**4.	Clone:** This function takes the output from the selection function and clone rate value as input parameters. Based on the clone rate, the chromosomes/tuples of a population are copied and the new population set for the next generation is obtained as an outcome of this function that includes cloned chromosomes/tuples.
**5.	Mutation:** This function alters one or more attributes/genes of each chromosome/tuple of a population and generates a mutated population set. Input parameters include the cloned population and mutation rate. On each gene/attribute of a tuple/chromosome, the mutation rate is applied. The mutated population is considered to be the next generation population set.

Steps 2-5 are repeated until a defined stop condition is reached. After completing its execution, the AIS algorithm produces a new minority class population set. This way, we oversample the minority class, update the training set, and fit the model to calculate various performance evaluation metrics including accuracy, g-mean, f-score, precision, and recall to understand the impact of AIS on the imbalance datasets.  We also tried to apply popular oversampling and undersampling techniques after the use of our proposed AIS system to further enhance the models’ performance and address the class imbalance issue.

  #### **6.2 Flow chart for AIS algorithm**
  ![image](https://user-images.githubusercontent.com/58121387/115758300-f6f55200-a36c-11eb-9afe-765b8adc3586.png)

  #### **6.3 Pseudo code for AIS**
  ![image](https://user-images.githubusercontent.com/58121387/115759899-c6161c80-a36e-11eb-8b48-bb787c1b9b2d.png)

## ** 7. Conclusion:**
AIS are defined as intelligent computational algorithms inspired by the biological immune systems and gained a lot of attention from the past decades. We carried out a study to implement an AIS inspired algorithm as a sampling strategy to solve the class imbalance issue. We used a set of predictive models with the AIS algorithm to generate synthetic minority class samples and observed the results of several performance evaluation metrics. We found that the main drawback of the AIS is the generation of a very small number of synthetic samples compared to other sampling algorithms. The reasons for this could include the use of f-scores in stop condition, the size of the datasets, or the AIS parameters. However, this drawback has no bearing on the AIS algorithm results. In the majority of the datasets tested in our study, the AIS algorithm’s performance alone is equivalent to that of other oversampling/undersampling algorithms applied on the original dataset. This study helped us understand that, despite the small size of the generated sample set, they are the best samples. On the other hand, this also becomes an advantage of the AIS system proposed as a good performance is achieved by using a smaller dataset. To further explore the impact of the imbalance on the AIS sampled training set, we also experimented the application of suitable sampling algorithm to allow balancing the problem classes.

Overall, we find our AIS proposal to be competitive against other popular oversampling and undersampling algorithms. Moreover, a similar or better performance is achieved with a reduced number of synthetic cases. 

As future work, we would like to further apply our solution to other problem domains. Moreover, the proposed AIS algorithm could also be extended to the majority class cases for which we could generate good representatives, and this way we could perform undersampling. Another possible direction regards the exploration of other metrics for being included in the algorithm stopping criteria.



## **8. References**
1.	https://archive.ics.uci.edu/ml/datasets/ILPD+(Indian+Liver+Patient+Dataset). Last Accessed: 2020-02-01.   

2.	https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+%28Original%29 . Last Accessed: 2020-02-01.  

3.	https://sci2s.ugr.es/keel/dataset.php?cod=155 . Last Accessed: 2020-02-01.  

4.	https://archive.ics.uci.edu/ml/datasets/EEG+Eye+State . Last Accessed: 2020-02-01.  

5.	https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients . Last Accessed: 2020-02-01.  
 
6.	https://www.kaggle.com/mlg-ulb/creditcardfraud/ . Last Accessed: 2020-02-01.  

7.	https://www.kaggle.com/uciml/german-credit . Last Accessed: 2020-02-01.  

8.	Duangjai Jitkongchuen and Warattha Sukpongthai.  Handling imbalanced data classification problem using artificial immune system with mahalanobis distance. In 2019   20th IEEE/ACIS International Conference on  Software  Engineering,  Artificial  Intelligence,  Networking, and  Parallel/Distributed Computing (SNPD), pages 67–71. IEEE, 2019.

